<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README_temp</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="pandoc.css" />
</head>
<body>
<h1
id="hermite-interpolation-with-bernstein-polynomials-bézier-curves">Hermite
Interpolation with Bernstein Polynomials (Bézier Curves)</h1>
<p><a href="../README.html#api-documentation">Back..</a></p>
<p>This set of functions is focused on generating piecewise Bézier
curves with applications to trajectory generation. Our method guarantees
an arbitrarily high continuity constraint is met between segments while
retaining the Bernstein parameterization. To generate these curves we
solve the Hermite interpolation problem using Bernstein polynomials.
These methods are particularly useful in trajectory generation
applications where derivative constraints at boundary conditions must be
satisfied when downstream algorithms may wish to differentiate the
trajectory. The Bernstein polynomial basis is a natural choice for
trajectory planning because it has closed form solutions for the
parameters of the integral and derivative of the polynomial.
Furthermore, the polynomial parameters (called control points) can be
used for a number of collision checking and bounding algorithms.</p>
<p><strong>Version:</strong> 1.0</p>
<h2 id="reference">Reference</h2>
<p>This content is based on the work presented in:</p>
<p><a
href="https://ntrs.nasa.gov/citations/20230013467">NASA/TM–20230013467</a>:
“On Hermite Interpolation using Bernstein Polynomials for Trajectory
Generation” by Andrew Patterson, Gage MacLin, Michael Acheson, Camilla
Tabasso, Venanzio Cichella, and Irene Gregory.</p>
<h2 id="interphermbern"><a
href="./interpHermBern.m"><code>interpHermBern</code></a></h2>
<p>The <code>interpHermBern</code> function performs Hermite
interpolation using Bernstein basis functions. This method is
particularly useful where smooth curves through specified points with
given tangents are required.</p>
<center>
<img src=".graphics/result.gif" width="450" height="450" />
</center>
<h3 id="description">Description</h3>
<p>The <code>interpHermBern</code> function constructs a curve that
passes through given points while satisfying specified derivative
conditions at these points. Together the point and its derivatives form
a waypoint (<code>wpts</code>). It utilizes the Hermite interpolation
framework, which is enhanced by expressing polynomial terms in Bernstein
basis form for numerical stability and downstream compatibility.</p>
<h3 id="inputs">Inputs</h3>
<ul>
<li><strong><code>wpts</code>:</strong> A matrix where each column
represents the points through which the curve must pass. The first
column contains values at these waypoints, while the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>k</mi><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi></mrow></msup><annotation encoding="application/x-tex">k^\mathrm{th}</annotation></semantics></math>
column provides the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>k</mi><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi></mrow></msup><annotation encoding="application/x-tex">k^\mathrm{th}</annotation></semantics></math>
derivative. The first row of the matrix is the starting waypoint, the
second row is the terminal waypoint of the polynomial segment. ECHO is
off.</li>
<li><strong><code>tint</code>:</strong> A two-element vector
<code>[a, b]</code> defining the interval over which the interpolation
occurs.</li>
</ul>
<h3 id="outputs">Outputs</h3>
<ul>
<li><strong><code>Q</code>:</strong> A vector of control points for the
interpolating curve in Bernstein basis representation. These control
points define a polynomial that meets the specified conditions at
<code>wpts</code>.</li>
</ul>
<h3 id="example-usage">Example Usage</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">% Define the time interval of interest, t_0=0s t_1=2s</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">tint</span> <span class="op">=</span> [<span class="fl">0</span> <span class="fl">2</span>]<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">% Define the waypoints,</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">% waypoint_0 [position=0, velocity=0, acceleration=0,...]</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">% waypoint_1 [position=1, velocity=1, acceleration=0,...]</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="va">wpts</span> <span class="op">=</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">1</span> <span class="fl">1</span> <span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">% Run interpolation function</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="va">Q</span> <span class="op">=</span> <span class="va">interpHermBern</span>(<span class="va">wpts</span><span class="op">,</span> <span class="va">tint</span>)<span class="op">&#39;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">% Take first and second derivatives to verify </span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="va">Q1</span> <span class="op">=</span> <span class="va">diffBernControl</span>(<span class="va">Q</span><span class="op">,</span><span class="va">tint</span><span class="op">,</span><span class="fl">1</span>)<span class="op">&#39;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="va">Q2</span> <span class="op">=</span> <span class="va">diffBernControl</span>(<span class="va">Q</span><span class="op">,</span><span class="va">tint</span><span class="op">,</span><span class="fl">2</span>)<span class="op">&#39;</span></span></code></pre></div>
<p>OUTPUT:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>    <span class="va">Q</span> <span class="op">=</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">0</span> <span class="fl">0.2</span> <span class="fl">0.6</span> <span class="fl">1</span>]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">Q1</span> <span class="op">=</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">0.5</span> <span class="fl">1</span> <span class="fl">1</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">Q2</span> <span class="op">=</span> [<span class="fl">0</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">0</span>]</span></code></pre></div>
<p>Note that <code>Q([1 end])==wpts(:,1)'</code>,
<code>Q1([1 end])==wpts(:,2)'</code>,
<code>Q2([1 end])==wpts(:,3)'</code> which, by the properties of the
control points of a Bernstein polynomial, implies that the initial and
final values of the position, velocity, and acceleration curves are
correct. ### Dependencies <strong>Required</strong> -
<code>binomCoeffs</code></p>
<p><strong>Optional</strong> - <code>diffBernControl</code></p>
<h3 id="limitations-and-considerations">Limitations and
Considerations</h3>
<p>While theoretically, any order of derivative constraints can be
considered, there are practical limitations to this parameterization due
to floating point arithmetic. The primary limitation of this code is in
its reliance on repeated differences, computed using the
<code>binomCoeffs</code> function. Repeated differences can lead to
numeric issues. Two breakpoints to keep in mind are:</p>
<ul>
<li>The number of derivatives must be less than 25 to maintain
precision.</li>
<li>For practical implementations, ensure the number of derivatives is
kept below 80 to avoid numerical issues like NaNs.</li>
</ul>
<p><a href="../README.html#api-documentation">Back..</a></p>
</body>
</html>
